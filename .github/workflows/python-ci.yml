name: Python CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  code-quality:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ['3.9', '3.10', '3.11']

    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v4
      with:
        python-version: ${{ matrix.python-version }}
    
    - name: Check Python syntax
      run: |
        echo "Checking Python syntax..."
        python -m py_compile main.py
        python -m py_compile app.py
        python -m py_compile download_datasets.py
        find src -name "*.py" -type f -exec python -m py_compile {} \;
        echo "✓ All Python files have valid syntax"
      continue-on-error: false
    
    - name: Verify project structure
      run: |
        echo "✓ Verifying project structure..."
        [ -f main.py ] && echo "  ✓ main.py" || (echo "  ✗ main.py missing" && exit 1)
        [ -f app.py ] && echo "  ✓ app.py" || (echo "  ✗ app.py missing" && exit 1)
        [ -f requirements.txt ] && echo "  ✓ requirements.txt" || (echo "  ✗ requirements.txt missing" && exit 1)
        [ -d src ] && echo "  ✓ src/" || (echo "  ✗ src/ missing" && exit 1)
        [ -d data ] && echo "  ✓ data/" || (echo "  ✗ data/ missing" && exit 1)
        [ -f README.md ] && echo "  ✓ README.md" || (echo "  ✗ README.md missing" && exit 1)
        [ -f LICENSE ] && echo "  ✓ LICENSE" || (echo "  ✗ LICENSE missing" && exit 1)
        echo "✓ All required files exist!"
      continue-on-error: false

  summary:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: ✅ CI Check Complete
      run: echo "✅ Code quality checks passed!"
